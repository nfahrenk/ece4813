{% extends "base.html" %}
{% block extra_styles %}
<style>
body {
    padding-left: 30px;
    padding-right: 30px;
}
#malware {
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

#malware td, #malware th {
    border: 1px solid #ddd;
    padding: 8px;
}

#malware tr:nth-child(even){background-color: #f2f2f2;}
#malware tr:last-child{max-width: 200px;}

#malware tr:hover {background-color: #ddd;}

#malware th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: left;
    background-color: #4CAF50;
    color: white;
}
</style>
{% endblock %}
{% block title %}List of Malware{% endblock %}
{% block content %}
<center>
<form method="GET" action="/malware">
    <!--
    <select name="file_type">
        {% for file_type in file_type_options %}
        <option value="{{file_type}}">{{file_type}}</option>
        {% endfor %}
    </select>
    -->
    <label for="av_detec">AV Detec:</label>
    <select name="av_detec">
        <option value="">---</option>
        {% for av_detec in av_detec_options %}        
        <option value="{{av_detec}}">{{av_detec}}</option>
        {% endfor %}
    </select>
    <!--
    <select name="domains">
        {% for domains in domains_options %}
        <option value="{{domains}}">{{domains}}</option>
        {% endfor %}
    </select>
    -->
    <label for="ip_address">IP Address:</label>
    <input type="text" name="ip_address"/>
    <br>
    <label for="from_sus_score">From Sus Score:</label>
    <input type="number" name="from_sus_score" step="0.1"/>
    <label for="from_sus_score">To Sus Score:</label>
    <input type="number" name="to_sus_score" step="0.1"/>
    <button type="submit">Filter</button>
</form>
<a href="{{prev_page if prev_page else 'javascript:void(0)'}}">Previous Page</a> <a href="{{next_page if next_page else 'javascript:void(0)'}}">Next Page</a>
</center>
<table id="malware">
    <tr>
        {# <th>sha256</th> #}
        <th>file type</th>
        <th>ingest date</th>
        <th>file name</th>
        <th>sus score</th>
        <th>sources</th>
        <th>av detec</th>
        <th>ip address</th>
    </tr>
    {% for row in malware %}
        <tr>
            {# <td>{{row.sha256}}</td> #}
            <td>{{row.file_type}}</td>
            <td>{{row.ingest_date}}</td>
            <td>{{row.file_name}}</td>
            <td>{{row.sus_score}}</td>
            <td>{{row.sources}}</td>
            <td>{{row.av_detec}}</td>
            <td>{{';<br>'.join(row.ip_address.split(';'))|safe if row.ip_address else ''}}</td>
        </tr>
    {% endfor %}    
</table>
{% endblock %}
